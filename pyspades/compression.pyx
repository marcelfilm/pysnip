# Copyright (c) Mathias Kaerlev 2011.# This file is part of pyspades.# pyspades is free software: you can redistribute it and/or modify# it under the terms of the GNU General Public License as published by# the Free Software Foundation, either version 3 of the License, or# (at your option) any later version.# pyspades is distributed in the hope that it will be useful,# but WITHOUT ANY WARRANTY; without even the implied warranty of# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the# GNU General Public License for more details.# You should have received a copy of the GNU General Public License# along with pyspades.  If not, see <http://www.gnu.org/licenses/>.cdef extern from "stdlib.h":    void free(void* ptr)    void * malloc(size_t size)cdef extern from "re_decomp.c":    struct struct_code_tables:        pass    unsigned int decompress_1(struct_code_tables * code_tables, unsigned char * in_data,         unsigned int in_size, unsigned char *out_data, int out_size)cdef unsigned char * buffer = <unsigned char *>malloc(4096)cdef struct_code_tables * code_tables = <struct_code_tables *>malloc(65536)cpdef decompress(data):    cdef unsigned int bytesread = decompress_1(code_tables,         data, len(data), buffer, 4096)    return (<char *>buffer)[:bytesread]