from twisted.internet.task import LoopingCallimport randomDISCO_COLORS = set([    (235, 64, 0),    (128, 232, 121),    (220, 223, 12),    (43, 72, 228),    (216, 94, 231),    (255, 255, 255)])def apply_script(protocol, connection, config):    class DiscoProtocol(protocol):        current_colors = None        def __init__(self, *arg, **kw):            protocol.__init__(self, *arg, **kw)            self.disco_loop = LoopingCall(self.update_color)            self.disco_loop.start(0.5)                def update_color(self):            if not self.current_colors:                self.current_colors = DISCO_COLORS.copy()            color = self.current_colors.pop()            self.set_fog_color(color)    return DiscoProtocol, connection